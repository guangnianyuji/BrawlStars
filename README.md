# **项目信息介绍**

## **项目名称：荒野乱斗**

## **项目成员：孙亦菲2152085，汪乘羽2153000**

## **成员贡献比例：孙亦菲50%：汪乘羽50%**

**项目GitHub地址：**https://github.com/guangnianyuji/BrawlStars.git

## **项目进度时间线：**

| 4.30 | 创建项目                                                     |
| ---- | ------------------------------------------------------------ |
| 5.2  | 学习git、cocos2dx 有关知识，环境搭建                         |
| 5.10 | 完成开始游戏场景                                             |
| 5.11 | 完成背景音乐相关的菜单功能                                   |
| 5.15 | 完成移动摇杆的设计                                           |
| 5.22 | 完成第一张地图设计，英雄移动，播放行走动画，视野随玩家移动的功能 |
| 5.26 | 完成向所有实体类增添血条，初步尝试添加碰撞监听               |
| 5.28 | 完成普攻摇杆、大招摇杆                                       |
| 5.29 | 完成创建房间场景，切换场景                                   |
| 5.30 | 放置AI在地图上                                               |
| 5.31 | 添加毒雾效果                                                 |
| 6.3  | 完成宝箱                                                     |
| 6.4  | 完成暂停游戏功能                                             |
| 6.5  | 尝试写AI功能                                                 |
| 6.10 | 添加幸存者人数标签，选择地图功能，结算界面功能               |
| 6.11 | 完成AI，完成项目文档，完成答辩PPT                            |

# **项目开发文档**

## **游戏整体架构设计**

![img](file:///D:\Temp\Temp\ksohtml63980\wps21.jpg)![img](file:///D:\Temp\Temp\ksohtml63980\wps22.jpg)![img](file:///D:\Temp\Temp\ksohtml63980\wps23.jpg) 

## **小组分工**

| 组员   | 完成项                                                       |
| ------ | ------------------------------------------------------------ |
| 孙亦菲 | 地图素材制作，创建房间，走动摇杆设计，人物走动动画制作，毒雾，宝箱，暂停及恢复功能，选择地图功能 |
| 汪乘羽 | 人物技能设计，攻击大招特效，菜单，背景音乐控制，AI（有限状态机），攻击摇杆设计 |

## **实现的功能点：**

### **基本功能：**

R游戏开始界面

R背景音乐

R音量控制

R暂停与恢复功能

R退出功能

R至少设计一张荒野乱斗地图

R添加能量宝箱，宝箱能给英雄增加生命值和伤害值

R至少设计4个英雄，不同英雄普通攻击和超级技能不同

R普攻可以积累大招

R支持创建房间

R键盘控制人物走动操作

R鼠标控制人物进行普通攻击和超级技能

R支持添加AI

R随着时间流逝，地图边缘出现毒圈

R最终存活的玩家为吃鸡者

R不同名次获得奖杯不同

### **新开发功能：**

R支持移动摇杆控制玩家行走（任意角度走动）

R支持攻击摇杆控制玩家发射技能

R自由选择地图

R攻击、大招特效

### **技术难点：**

1、为了便于维护AI的逻辑，选择FSM（有限状态机）设计AI，不主动在update函数里检测AI的状态，利用消息驱动实现AI状态的切换，设计了一个类“NotifyUtil"，以满足本游戏额外的需求，实现事件驱动的功能。

2、cocos封装的chipmunk物理引擎有一定缺陷，将英雄和墙壁都设置成静态刚体较符合正常逻辑，但无法使用碰撞检测。因此为了避免穿透墙壁和障碍物，用检查坐标的方式重新封装了障碍物类的碰撞检测。

 

 

### **加分项和亮点：**

1、脱离了荒野乱斗英雄普攻都是发射子弹的限制，添加了范围攻击（如喷泉攻击，闪电攻击，蝙蝠攻击，迷雾攻击等），每次普攻和大招都有精美动画。

 

2、使用摇杆、攻击使行走更自由顺畅，与荒野乱斗游戏还原度高。

 

3、自行绘制的原创地图和画风一致的精美UI。

 

4、物理引擎的使用。各个物体之间的碰撞消息均由物理引擎发出，而在障碍物上又通过自主设计碰撞算法解决了问题。

 

5、AI的有限状态机的使用，利用消息驱动实现AI状态的切换。

 

### **C++11新特性：**

1ambda表达式：

![img](file:///D:\Temp\Temp\ksohtml63980\wps24.jpg) 

 

std::function

![img](file:///D:\Temp\Temp\ksohtml63980\wps25.jpg) 

基于范围的for循环

 

![img](file:///D:\Temp\Temp\ksohtml63980\wps26.jpg) 

 

 

auto 类型推断

项目几乎处处使用

 

 

### **游戏截图**

 

![img](file:///D:\Temp\Temp\ksohtml63980\wps27.jpg)![img](file:///D:\Temp\Temp\ksohtml63980\wps28.jpg)![img](file:///D:\Temp\Temp\ksohtml63980\wps29.jpg)![img](file:///D:\Temp\Temp\ksohtml63980\wps30.jpg) 